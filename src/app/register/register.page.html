<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/" (click)="goBack()"></ion-back-button>
    </ion-buttons>
    <ion-title>Registro</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="register-form">
    <form [formGroup]="registerForm">
      <!-- <ion-item>
        <ion-label position="floating">Nombre de usuario</ion-label>
        <ion-input type="text" formControlName="username"></ion-input>
      </ion-item> -->

      <!-- <div>
          lo borre para probar el auth y el guardar usuarios 
        
        {{userService.formularioServ | json }}
      </div> -->

      <ion-item>
        <ion-label position="floating">Nombre Completo</ion-label>
        <ion-input type="text" formControlName="nombre" name="nombre" [(ngModel)]="nombre"></ion-input>
        <ion-text color="danger" *ngIf="registerForm.get('nombre')?.invalid && registerForm.get('nombre')?.touched">
          El nombre es requerido.
        </ion-text>
      </ion-item>

      <!-- <ion-item>
        <ion-label position="">Foto Estudiante</ion-label>
      </ion-item> -->

      <ion-item class="photo-item">
        <ion-button (click)="addPhotoToGallery()" class="custom-button" expand="full">
          <ion-icon name="camera" class="camera-icon"></ion-icon>
          Foto estudiante
        </ion-button>

        <ion-col size="3" class="photo-col">
          <ion-img [src]="photoService.photo?.webviewPath" class="photo-img"></ion-img>
        </ion-col>
      </ion-item>

      <!-- <ion-item>
        <ion-button (click)="addPhotoToGallery()" label="Foto estudiante:">
          <ion-icon name="camera"></ion-icon>
        </ion-button>
        
        <ion-col size="3">
          <ion-img [src]="photoService.photo?.webviewPath"></ion-img>
        </ion-col>
      </ion-item> -->

      <ion-item>
        <ion-label position="floating">Correo electrónico</ion-label>
        <ion-input type="email" formControlName="email" name="email" [(ngModel)]="email"></ion-input>
        <ion-text color="danger" *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">
          Por favor, introduce un correo electrónico válido.
        </ion-text>
      </ion-item>

      <ion-item>
        <ion-label position="floating">Contraseña</ion-label>
        <ion-input type="password" formControlName="password" name="password" [(ngModel)]="password"></ion-input>
        <ion-text color="danger" *ngIf="registerForm.get('password')?.invalid && registerForm.get('password')?.touched">
          La contraseña debe tener entre 4 y 20 caracteres.
        </ion-text>
      </ion-item>

      <ion-item>
        <ion-label position="floating">Carrera</ion-label>
        <ion-input type="text" formControlName="carrera" name="carrera" [(ngModel)]="carrera"></ion-input>
        <ion-text color="danger" *ngIf="registerForm.get('carrera')?.invalid && registerForm.get('carrera')?.touched">
          Por favor, introduce una carrera.
        </ion-text>
      </ion-item>

      <ion-item>
        <ion-label position="floating">RUT</ion-label>
        <ion-input type="text" formControlName="rut" name="rut" [(ngModel)]="rut"></ion-input>
        <ion-text color="danger" *ngIf="registerForm.get('rut')?.invalid && registerForm.get('rut')?.touched">
          Por favor, introduce un RUT válido.
        </ion-text>
      </ion-item>

      <ion-item>
        <ion-label position="floating">Fecha de nacimiento</ion-label>
        <ion-datetime displayFormat="MMMM DD, YYYY" formControlName="fechaNacimiento" name="fechaNacimiento"
          [(ngModel)]="fechaNacimiento"></ion-datetime>
      </ion-item>

      <br>

      <ion-item class="custom-item">
        <ion-label position="floating" class="custom-label">Región</ion-label>
        <ion-select formControlName="idRegion" name="idRegion" placeholder="Seleccione" class="custom-select">
          <ion-select-option *ngFor="let i of regiones" [value]="i.id">{{i.nombre}}</ion-select-option>
        </ion-select>
        <br>
        <ion-text color="danger" *ngIf="registerForm.get('idRegion')?.invalid && registerForm.get('idRegion')?.touched">
          Por favor, selecciona una región.
        </ion-text>
      </ion-item>

      <ion-item *ngIf="registerForm.get('idRegion')?.value" class="custom-item">
        <ion-label position="floating" class="custom-label">Comuna</ion-label>
        <ion-select formControlName="idComuna" name="idComuna" placeholder="Seleccione" class="custom-select">
          <ion-select-option *ngFor="let i of comunas" [value]="i.id">{{i.nombre}}</ion-select-option>
        </ion-select>
        <br>
        <ion-text color="danger" *ngIf="registerForm.get('idComuna')?.invalid && registerForm.get('idComuna')?.touched">
          Por favor, selecciona una comuna.
        </ion-text>
      </ion-item>


      <!-- <ion-item>
        <ion-label position="floating">Region</ion-label>
        <ion-select formControlName="idRegion" placeholder="Seleccione">
          <ion-select-option *ngFor="let i of regiones" [value]="i.id">{{i.nombre}}</ion-select-option>
        </ion-select>
      </ion-item>

      <ion-item *ngIf="registerForm.get('idRegion')?.value">
        <ion-label position="floating">Comuna</ion-label>
        <ion-select formControlName="idComuna" placeholder="Seleccione">
          <ion-select-option *ngFor="let i of comunas" [value]="i.id">{{i.nombre}}</ion-select-option>
        </ion-select>
      </ion-item> -->

      <ion-button class="ion-margin-top" expand="block" fill="clear" color="success" (click)="guardar()"
        type="submit">Registrarse</ion-button>
    </form>
  </div>

</ion-content>